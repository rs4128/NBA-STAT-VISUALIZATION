[["index.html", "COVID, Kobe, and Injury in the NBA Chapter 1 Introduction 1.1 Why basketball?", " COVID, Kobe, and Injury in the NBA Santos Hernandez and Rahul Subramaniam 2021-04-11 Chapter 1 Introduction 1.1 Why basketball? In short, we are basketball nerds. A shared love of the game brought us both to the topic in general. However, sports analytics have traditionally been most associated with baseball through sabermetrics – the long established empirical analysis of baseball statistics. There is even a movie about baseball stats with Brad Pitt, Moneyball. After all, the game is slow enough that anyone could keep track of what the players are doing! Yet, in the sports world, this is changing. Data science is growing in basketball. Even NBA Commissioner Adam Silver has said, “Analytics are part and parcel of virtually everything we do now.” Evidence for this exists in the rise of the 3-point shot in modern basketball, as data analysts figured out this is the more efficient way to win games. Since basketball analytics is relatively new, there are still many unanswered questions. Furthermore, most analyses are trying to understand to the formula to winning more games. So, we wanted to pursue questions that connected basketball players to the greater world. We decided on these questions to explore: COVID19 more or less put sports on hold as seasons were paused or canceled entirely. Like other leagues, the NBA suspended their season indefinitely in March 2020 after COVID was spiking in the US. However, the NBA was able to successfully finish out their season in a unique way. They held 8 regular season games and the playoffs in a ‘bubble’ in Orlando, where teams all stayed together with limited interaction to the outside world. So we ask, how did the COVID19 pandemic affect overall NBA team performances? 2020 was also a big year for basketball for another reason, the unfortunate passing of Kobe Bryant, a player widely considered to be one of the all time greats. Many players publicly stated the emotional impact of his passing, rocking the basketball community. But by looking at the data, can we see if the death of Kobe Bryant affected their game performance meaningful way? Finally, although not directly related to any event of 2020, many top players had to sit out the 2019-20 season entirely due to injury. Notably, Kevin Durant spent his first season in Brooklyn on the bench due to an Achille’s tear. In the NBA, is injury related to position or player statistics in some way? Has this changed over time through certain eras of playstyle? "],["data-sources.html", "Chapter 2 Data sources 2.1 Game statistics 2.2 Player positions and injuries 2.3 Issues", " Chapter 2 Data sources 2.1 Game statistics In the NBA, the largest source of game statistics comes from the league itself. This data is publicly available at the NBA website, with some stats going back as far as 1946. Scorekeepers are hired to watch every single game, tracking every statistic that is available to us. Many of the statistics are raw counts of things like points, minutes played, and rebounds, while others are calculated metrics. This does not discount the fact that the stats we see are subject to human error, but generally, the NBA is the best data source available for game statistics. NBAstatR is a package that crawls the website to return the data directly in R. The game data is aggregated and rolled up based on specified parameters. For example, one could request the per-game averages of each team for the 2015 season, from March to April. The package would return a table with a row for each team, with average statistics for allgames played in that time period. This reflects the behavior of the NBA stats website, which does the same thing. There are 30 teams in the modern NBA, so 30 rows are always returned in requests for team statistics. When requesting player data, the number of rows can vary because not every player plays every game and people are constantly getting added/dropped from rosters. Generally, for the whole regular season, there are between 500-550 rows of unique player data. Less are returned for requests of smaller windows of time, as some players may not play at all during that time. Basketball stats are complicated. There are a seemingly endless amount of statistics that are available for each player and team. For example, the “Traditional” stats reported include things like 3 Point Field Goals Made, Free Throw Percentage, Rebounds, Assists, and Steals, among many others. For our project, we were most interested understanding general team/player performance, which can be difficult to discern from all of those statistics. So, we focused on the Offensive, Defensive, and Net ratings. The Offensive rating can be understood as the amount of points produced on offense when the player was on the court, while Defensive rating can be understood as the amount of points allowed on defense when the player was on the court. The way these are calculated are somewhat complicated, but are a good way to understand general performance. Team versions of these ratings are calculated based on the underlying player statistics. 2.1.1 COVID cases A single table was scraped from a basketball magazine’s website (SLAM) to get a list of players that were confirmed to have COVID, and when it was reported by the magazine. 2.2 Player positions and injuries We also needed other data that went beyond game statistics: player position data and injury data. The NBA also makes this data somewhat available on its website, does not aggregate and release it as conveniently. Player position data is limited only to forward, guard, and center, while most think of the game as played in 5 positions - point guard, shooting guard, small forward, power forward, and center. Injury data available on the website is only for current injuries, and is not historical. ////EXPAND VVV We turned to Basketball Reference for more complete player profiles. T his data is collected by a parent organization that manages several sports databases. The core of its historical data comes from Sean Lahman, a researcher/journalist famous for compiling open source sports data and encyclopedias. Injury data was scraped from Pro Sports Transactions, which compiles data that is released by the NBA. 2.3 Issues When we compare a “month” of game data for each team, each team may not have played the same amount of games due to scheduling. The sample for each average can be slightly unequal by +/- a game played from team to team. The solution to this would be to obtain averages based on the number of games played before a certain date, but the API lacks this slicing capability. It might be possible pull the box scores of every single game, count out and filter based on date, and then create the averages manually, but this approach would be a significant amount of work for perhaps a small change in results. As previously stated, we are looking for differences in general performance. "],["data-transformation.html", "Chapter 3 Data transformation 3.1 Game statistics 3.2 Injuries 3.3 Player positions 3.4 d3", " Chapter 3 Data transformation 3.1 Game statistics When using the NBA stats R package, requested data comes as a nested dataframe. Each row has data for a single season, with either regular season or playoff data. So if you requested 2018-19 and 2019-2020 data for the regular season and playoffs, 4 rows would be returned. A column at the end has the actual game stats dataframes, so these must be unnested. covid_season_month_before &lt;- teams_players_stats(seasons = 2020, measures = &quot;Advanced&quot;, types = &quot;team&quot;, tables = &quot;general&quot;, modes = &quot;PerGame&quot;, date_from = &quot;2-11-20&quot;, date_to = &quot;3-11-20&quot;) %&gt;% unnest(dataTable) %&gt;% mutate(df_type = &quot;month_before&quot;) bubble &lt;- teams_players_stats(seasons = 2020, measures = &quot;Advanced&quot;, types = &quot;team&quot;, season_types = c(&quot;Regular Season&quot;, &quot;Playoffs&quot;), tables = &quot;general&quot;, modes = &quot;PerGame&quot;, date_from = &quot;7-29-20&quot;, date_to = &quot;10-11-20&quot;) %&gt;% unnest(dataTable) We split the time periods that we wanted to compare into separate dataframes and added a new column, df_type, to distinguish them. bubble_seeding &lt;- bubble %&gt;% filter(typeSeason == &quot;Regular Season&quot;) %&gt;% mutate(df_type = &quot;bubble_seeding&quot;) bubble_playoffs &lt;- bubble %&gt;% filter(typeSeason == &quot;Playoffs&quot;) %&gt;% mutate(df_type = &quot;bubble_playoffs&quot;) Finally, we made the data long for it to work with ggplot. The data when requested comes wide, with a column for each statistic. bubble_stats_long &lt;- bind_rows(covid_season_month_before, bubble_seeding, bubble_playoffs,) %&gt;% select(nameTeam:paceE, df_type, -contains(&quot;rank&quot;)) %&gt;% #drop some stats we&#39;re not interested in pivot_longer(gp:paceE, names_to = &quot;rating&quot;, values_to = &quot;value&quot;) %&gt;% semi_join(bubble_teams, by = &quot;nameTeam&quot;) #only teams that were invited to bubble The same process was used for both team and player data because they come in the same form. 3.1.1 COVID cases Some additional steps were taken to integrate the COVID case data. The table from SLAM was crawled with rvest and cleaned slightly to be able to join onto the player stats. Furthermore, the dates were converted into date objects so that they would display in order on the x-axis. covid_players &lt;- read_html(&quot;https://www.slamonline.com/nba/nba-coronavirus-covid-list/&quot;) %&gt;% html_element(css = &quot;.wp-block-table&quot;) %&gt;% html_table(header = TRUE) covid_players_fixed &lt;- covid_players %&gt;% rename(name = &quot;Player&quot;, date_reported = &quot;Reported&quot;) %&gt;% mutate(team_abb = str_sub(name, -4, -2), name = str_remove(name, &quot; \\\\(.+\\\\)&quot;), date_reported = str_remove(date_reported, &quot; \\\\(.+\\\\)&quot;), date_reported = mdy(str_c(date_reported, &quot; 2020&quot;))) 3.2 Injuries 3.3 Player positions 3.4 d3 A small amount of tooling was required to use the NBAstatR data with d3. To make the amount of players more manageable, we pared down the total number of players in the dataset to just the big names on each team. There are a number of players that play only a few games each year and greatly skew their ranking data. So, get the best and most notable players, we needed to look beyond ratings. First, took data from the whole season for only starters. This already eliminates a lot of players – only reasonably good players get to start. Then, we took the top 6 ranks for each team by number of games started. starters &lt;- teams_players_stats(seasons = 2020, types = &quot;player&quot;, starters_bench = list(&quot;Starters&quot;)) %&gt;% unnest(dataTable) top_guys_bubble &lt;- starters %&gt;% semi_join(bubble_seeding_players, by = &quot;namePlayer&quot;) %&gt;% #only return players with bubble data, some players opted out semi_join(covid_season_players_month_before, by = &quot;namePlayer&quot;) %&gt;% group_by(slugTeam) %&gt;% slice_max(gp, n = 6) Once we found the list of players we wanted, we filtered our game data from these names. Then, we cut down the amount of game stats to just the ones we were interested in. Finally, we spread the data wide by time period so that data from each period would be associated with a single svg element. This would allow us to access this data easily, letting us read the data just once. Being d3 beginners, we were not sure of this approach. Maybe performance would have been better to add/remove dots as needed rather than load them all and hide/show them? Or even split the csv into three, one for each time period, loading as needed. Regardless, this approach worked! d3_data &lt;- bubble_season_combined %&gt;% semi_join(top_guys_bubble, by = &quot;namePlayer&quot;) %&gt;% left_join(bubble_teams, by = &quot;slugTeam&quot;) %&gt;% select(name = &quot;namePlayer&quot;, team_abb = &quot;slugTeam&quot;, team_name = &quot;nameTeam&quot;, ortg, drtg, netrtg, df_type ) %&gt;% pivot_wider(names_from = &quot;df_type&quot;, values_from = c(&quot;ortg&quot;, &quot;drtg&quot;, &quot;netrtg&quot;)) d3_data %&gt;% write_csv(&quot;data/d3_data.csv&quot;) "],["missing-values.html", "Chapter 4 Missing values", " Chapter 4 Missing values Due to the nature of the package/website, NA’s are never returned for game statistics. If a player is missing entirely from a request, that means they did not play at all for the requested time period. Any difference in the number of games used to calculate averages reflects the real world. If a game of statistics are missing from an average, they did not play that game due to whatever reason. For example, we noticed Kevin Durant missing data for the 19-20 season – this was due to a torn achilles sidelining him for the entire year. "],["results.html", "Chapter 5 Results 5.1 COVID", " Chapter 5 Results 5.1 COVID 5.1.1 Approach We decided to look at average game performance based on three distinct time periods: a month of games before the bubble (10-13 games), regular season games in the bubble (8 games), and playoffs. If the playing during the COVID era changed the way the teams played, we could see change between these periods. We decided to keep the playoffs separate, because team strategies can be different and generally, the stakes are much higher. As previously explained, we focused on the Offensive/Defensive/Net ratings to evaluate the way they played. Note: not every team made it into the playoffs and are lacking that playoff data accordingly. 5.1.2 Offense Comparing the offensive performances, some teams did a lot worse in the bubble seeding games than before the break. However, just as many seemed to actually do better in the bubble. We were pretty surprised to see that, considering that it had been about 4 months of downtime. Between the seeding games and playoffs, there were also big changes in either direction. The Trailblazers totally dropped off for post-season play, while it looks like the Lakers were sandbagging in the seeding games (they ultimately won the championship). 5.1.3 Defense However, looking at the defensive performance, teams mostly did slightly worse or about as well as they had been before the bubble. So, the bubble potentially had a slight negative effect on team defensive. Some teams actually did better than before – the Suns and Thunder stood out with major improvement in their seeding games, but these swings were much smaller than the largest negative swings. Note that a lower Defensive rating means better defensive play. The X-scale has been flipped to allow for easier comparison with Offensive and Net ratings. 5.1.4 Overall When combining the two to find the Net rating, the overall negative to neutral impact on defense is enough to swing overall performance in that direction. It is easy to see a large number of dots to the wall of the blue dots formed by ratings month before. In other words, overall performance for most teams looks worse or as good as before the bubble. There does not appear to be any relationship in this change to performance before the bubble, i.e. teams were impacted regardless of their previous rating. The slightly negative impact on defense/net rating was somewhat interesting, but we wanted to compare against a control. Perhaps a similar decrease in performance could be seen at the end of a regular season. So, we made similar charts for the 2018-19 season with the same teams. We chose three time periods that were similar to the bubble analysis: a month before the last 8 games, the last 8 games, and the playoffs. A similar amount of variance up and down can be seen in offense, and more in defense than the COVID season. The same decline in performance at the end of season can be see in the net ratings, although the changes looks even smaller than the COVID season. So, maybe the COVID season did not have much of an effect at all on net player performance at a team level, and the slight negative changes at the end of a season are more related to something else. Either way, the change in performance overall is not large and varies too much from team to team to really suggest a strong relationship. season_19_long %&gt;% filter(rating == &quot;ortg&quot;) %&gt;% semi_join(bubble_teams, by = &quot;nameTeam&quot;) %&gt;% #only teams that were invited to bubble mutate(ordered_teams = fct_reorder2(nameTeam, df_type == &quot;month_before&quot;, value, .desc = FALSE)) %&gt;% ggplot(aes(y = ordered_teams, x = value, color = df_type)) + geom_point() + scale_color_manual(values = c(&quot;month_before&quot; = &quot;#00bcd4&quot;, &quot;last_8&quot; = &quot;#ff9800&quot;, &quot;playoffs&quot; = &quot;#e91e63&quot;), labels = c(&quot;Month before last 8&quot;, &quot;Last 8 games&quot;, &quot;Playoffs&quot;), name = &quot;Time Period&quot;) + xlab(&quot;Offensive Rating&quot;) + ylab(NULL) season_19_long %&gt;% filter(rating == &quot;drtg&quot;) %&gt;% semi_join(bubble_teams, by = &quot;nameTeam&quot;) %&gt;% mutate(ordered_teams = fct_reorder2(nameTeam, df_type == &quot;month_before&quot;, value)) %&gt;% ggplot(aes(y = ordered_teams, x = value, color = df_type)) + geom_point() + scale_x_reverse() + scale_color_manual(values = c(&quot;month_before&quot; = &quot;#00bcd4&quot;, &quot;last_8&quot; = &quot;#ff9800&quot;, &quot;playoffs&quot; = &quot;#e91e63&quot;), labels = c(&quot;Month before last 8&quot;, &quot;Last 8 games&quot;, &quot;Playoffs&quot;), name = &quot;Time Period&quot;) + xlab(&quot;Defensive Rating&quot;) + ylab(NULL) season_19_long %&gt;% filter(rating == &quot;netrtg&quot;) %&gt;% semi_join(bubble_teams, by = &quot;nameTeam&quot;) %&gt;% #only teams that were invited to bubble mutate(ordered_teams = fct_reorder2(nameTeam, df_type == &quot;month_before&quot;, value, .desc = FALSE)) %&gt;% ggplot(aes(y = ordered_teams, x = value, color = df_type)) + geom_point() + scale_color_manual(values = c(&quot;month_before&quot; = &quot;#00bcd4&quot;, &quot;last_8&quot; = &quot;#ff9800&quot;, &quot;playoffs&quot; = &quot;#e91e63&quot;), labels = c(&quot;Month before last 8&quot;, &quot;Last 8 games&quot;, &quot;Playoffs&quot;), name = &quot;Time Period&quot;) + xlab(&quot;Net Rating (Offensive - Defensive)&quot;) + ylab(NULL) ### Players If the COVID bubble did not impact team performance, what about COVID itself? A number of players were reported to have contracted the virus during the suspension of the season. We tried to see if this had any kind of lasting impact, regardless of severity of symptoms. A quick search let us find the complete list of confirmed players that got COVID and when it was reported that they did. We filtered player data based on these names and sorted them based on when it was reported. We thought that given more time to recover, the greater chance that there was no impact on their performance. On the left was the first reported case in March, on the right was the most recent case in August, only two months from the start of the bubble. The chart shows that all but 5 players did worse than before the shutdown, and thus before they contracted COVID. Furthermore, 3 of the players that outperformed after the restart were on the far left. Rudy Gobert, Donovan Mitchell, and Marcus Smart were all reported to have gotten the virus in March, giving 7 months for recovery. On the far right, we can see Mo Bamba take an absolute nosedive on his return. Looking a further into this, it seems that his symptoms were long lasting, even past the end of the season. Although the sample is small, this suggests that COVID has a generally negative effect even past the time that players are cleared to play. Comparing the results to player performance from the previous year reinforces this, as there does not seem to be any sort of end of season slump trend among the majority of players. "],["interactive-component.html", "Chapter 6 Interactive component", " Chapter 6 Interactive component Below is an interactive visualization of individual player performance across the three time periods from the COVID analysis. Choose a team from the dropdown to narrow down the data to a single team’s top players. How these top players were selected is explained in the Data Transformation section. Each dot represents one player’s performance in a time period, with offensive ratings on the y-Axis and defensive ratings on a reversed x-Axis (because lower means better defense). Clicking between the three buttons below updates the player’s ratings to the selected time period. Movement shows how players improve/get worse in relation to each other between the different periods. Moving towards the top right means all around improvement, while moving towards the bottom left means worse performance. Click on a dot to highlight exact ratings and player name. The advantage of the interactive visualization lies in being able to zoom in and out on the fly – one can see a single player’s data against his team and the whole league. The movement also allows the user to get a more intuitive sense of how players got better/worse. Note: Teams that did not make the playoffs fly off the screen when selecting playoffs. "],["conclusion.html", "Chapter 7 Conclusion", " Chapter 7 Conclusion "]]
